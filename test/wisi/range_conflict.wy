;; grammar has a reduce-reduce conflict
;; (ediff "range_conflict.wy" "../../../org.opentoken.stephe/wisi/test/range_conflict.wy")

%{
(require 'wisi)
%}

%keyword IN "in"
%keyword LEFT_PAREN "("
%keyword RANGE "range"
%keyword RIGHT_PAREN ")"

%token <punctuation> DOT_DOT ".."
%token <punctuation> TICK "'"

%token <symbol> IDENTIFIER
%token <string> STRING_LITERAL

%start compilation_unit
%%

compilation_unit
  : membership_choice range
    (setq wisi-test-success t)
  ;

membership_choice
  : primary
  | range ;; note that this does _not_ conflict with RANGE
  ;

primary
  : IDENTIFIER
  | STRING_LITERAL
  | LEFT_PAREN relation RIGHT_PAREN
  ;

range
  : IDENTIFIER TICK RANGE LEFT_PAREN relation RIGHT_PAREN ;; a little weird, but it's a test
  | IDENTIFIER TICK RANGE
  | primary DOT_DOT primary
  ;

relation
  : primary IN membership_choice
  ;

%%
;;; end of file
