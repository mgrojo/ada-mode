;;; generated from python_ebnf.wy -*- buffer-read-only:t -*-
;;;
;; Python ebnf constructs that were problematic.

%meta_syntax BNF

%keyword NONLOCAL "nonlocal"
%keyword IN "in"
%keyword FOR "for"
%generate None

%start dictorsetmaker

%token <symbol> NAME %[ [$a-zA-Z\x80-\U0010FFFF][0-9a-zA-Z_\x80-\U0010FFFF]* ]%

%token <number> NUMBER %[ ([0-9])|([0-9][0-9eE._-]*[0-9]) ]%

%token <punctuation> COLON ":"
%token <punctuation> COMMA ","
%token <punctuation> EQUAL "="
%token <punctuation> STAR "*"
%token <punctuation> STAR_STAR "**"

test
  : expr
star_expr
  : STAR expr
expr
  : atom
atom
  : NAME
  | NUMBER

;; This nonterminal matches part of dictorsetmaker
testlist_comp
  : nonterminal_023 nonterminal_026
dictorsetmaker
  : nonterminal_033

comp_for
  : FOR expr IN test

expr_stmt
  : testlist_star_expr nonterminal_038
  ;

;; Simplified has a similar problem
expr_stmt_2
  : testlist_star_expr nonterminal_040
  ;

;; This was recognized as a canonical list, and 'nonlocal' left out.
nonlocal_stmt
  : NONLOCAL NAME nonterminal_041_list
  | NONLOCAL NAME
  ;

;; end of file
nonterminal_023
  : test
  | star_expr
  ;
nonterminal_025
  : COMMA nonterminal_023
  ;
nonterminal_024_list
  : nonterminal_025
  | nonterminal_024_list nonterminal_025
  ;
nonterminal_026
  : comp_for
  | nonterminal_024_list COMMA
  | nonterminal_024_list
  | COMMA
  | ;; empty
  ;
nonterminal_027
  : test COLON test
  | STAR_STAR expr
  ;
nonterminal_029
  : COMMA nonterminal_027
  ;
nonterminal_028_list
  : nonterminal_029
  | nonterminal_028_list nonterminal_029
  ;
nonterminal_030
  : comp_for
  | nonterminal_028_list COMMA
  | nonterminal_028_list
  | COMMA
  | ;; empty
  ;
nonterminal_031
  : nonterminal_027 nonterminal_030
  ;
nonterminal_033
  : nonterminal_031
  | testlist_comp
  ;
nonterminal_034
  : yield_expr
  | testlist
  ;
nonterminal_035
  : yield_expr
  | testlist_star_expr
  ;
nonterminal_037
  : EQUAL nonterminal_035
  ;
nonterminal_036_list
  : nonterminal_037
  | nonterminal_036_list nonterminal_037
  ;
nonterminal_038
  : annassign
  | augassign nonterminal_034
  | nonterminal_036_list
  | ;; empty
  ;
nonterminal_039_list
  : yield_expr
  | nonterminal_039_list yield_expr
  ;
nonterminal_040
  : nonterminal_039_list
  | ;; empty
  ;
nonterminal_042
  : COMMA NAME
  ;
nonterminal_041_list
  : nonterminal_042
  | nonterminal_041_list nonterminal_042
  ;
