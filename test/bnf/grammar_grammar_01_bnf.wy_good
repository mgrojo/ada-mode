;;; generated from grammar_grammar_01.wy -*- buffer-read-only:t -*-
;;;
;; Subset of wisitoken grammar for unit tests

%meta_syntax BNF
%generate LR1 Ada re2c
%start compilation_unit_list

%token <punctuation> BAR "|"
%token <punctuation> COLON ":"
%token <punctuation> SEMICOLON ";"

%token <symbol> IDENTIFIER %[ [a-zA-Z\x80-\U0010FFFF][0-9a-zA-Z_\x80-\U0010FFFF]* ]% "bogus"
%token <string-single-one-line> STRING_LITERAL_2 %[ (['][\x20-\x26\x28-\U0010FFFF]*['])+ ]% "''"

%non_grammar <non-reporting> WHITESPACE %[ [ \t] ]%
%non_grammar <new-line> NEW_LINE %[ [\x0a]|[\x0d][\x0a] ]%
%non_grammar <comment-new-line> COMMENT ";;"
%non_grammar <comment-new-line> COMMENT2 "--"
%non_grammar <delimited-text> RAW_CODE "%{" "}%"

%mckenzie_cost_default 2 2 2 2

nonterminal
  : IDENTIFIER COLON rhs_BAR_list SEMICOLON
  ;

;; We don't use "rhs_item*", because that puts the empty rhs last. If
;; it's first (as it used to be in wisitoken-grammar-mode), it
;; encountered a bug in error recover Left_Breakdown.
rhs
  : ;; empty
  | rhs_item_list
  ;

rhs_item
  : IDENTIFIER
  | STRING_LITERAL_2
  ;

compilation_unit_list
  : compilation_unit_list compilation_unit_list
  | compilation_unit_list nonterminal
  | nonterminal
  ;

;; end of file
rhs_BAR_list
  : rhs_BAR_list BAR rhs_BAR_list
  | rhs_BAR_list BAR rhs
  | rhs
  ;
rhs_item_list
  : rhs_item_list rhs_item_list
  | rhs_item_list rhs_item
  | rhs_item
  ;
